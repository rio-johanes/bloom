<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bloom - Kesehatan Mental Anda Prioritas Kami</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        .hero-bg {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
        }
        .card-hover:hover {
            transform: translateY(-5px);
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .lotus-logo {
            position: relative;
            width: 40px;
            height: 40px;
        }
        .lotus-petal {
            position: absolute;
            width: 20px;
            height: 30px;
            background-color: #10b981;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            transform-origin: center bottom;
        }
        .lotus-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 12px;
            height: 12px;
            background-color: #065f46;
            border-radius: 50%;
        }
        .lotus-petal:nth-child(1) { transform: rotate(0deg); }
        .lotus-petal:nth-child(2) { transform: rotate(45deg); }
        .lotus-petal:nth-child(3) { transform: rotate(90deg); }
        .lotus-petal:nth-child(4) { transform: rotate(135deg); }
        .lotus-petal:nth-child(5) { transform: rotate(180deg); }
        .lotus-petal:nth-child(6) { transform: rotate(225deg); }
        .lotus-petal:nth-child(7) { transform: rotate(270deg); }
        .lotus-petal:nth-child(8) { transform: rotate(315deg); }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: white;
            border-radius: 1rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        /* Progress Bar */
        .progress-bar {
            height: 8px;
            background-color: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #10b981;
            transition: width 0.3s ease;
        }
        
        /* Meditation Player */
        .meditation-player {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        /* Daily Login */
        .login-streak {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
        }
        
        /* Points Badge */
        .points-badge {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header & Navigation -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center">
                <h1 class="text-2xl font-bold text-green-600">Bloom</h1>
            </div>
            
            <nav class="hidden md:flex space-x-8">
                <a href="#beranda" class="text-green-600 font-medium hover:text-green-500">Beranda</a>
                <a href="#tes" class="text-gray-600 font-medium hover:text-green-500">Tes Kesehatan</a>
                <a href="#komunitas" class="text-gray-600 font-medium hover:text-green-500">Komunitas</a>
                <a href="#konsultasi" class="text-gray-600 font-medium hover:text-green-500">Konsultasi</a>
                <a href="#meditasi" class="text-gray-600 font-medium hover:text-green-500">Meditasi</a>
                <a href="#misi" class="text-gray-600 font-medium hover:text-green-500">Misi Harian</a>
            </nav>
            
            <div class="flex items-center space-x-4">
                <div id="pointsDisplay" class="hidden md:flex items-center bg-green-100 text-green-800 px-3 py-1 rounded-full">
                    <i class="fas fa-coins mr-1"></i>
                    <span id="pointsValue">0</span> Poin
                </div>
                <button id="loginBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full font-medium transition duration-300">
                    Masuk
                </button>
                <button id="registerBtn" class="hidden md:block border border-green-500 text-green-500 hover:bg-green-50 px-4 py-2 rounded-full font-medium transition duration-300">
                    Daftar
                </button>
                <button class="md:hidden text-gray-600" id="mobileMenuBtn">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="beranda" class="hero-bg py-16 md:py-24">
        <div class="container mx-auto px-4 flex flex-col md:flex-row items-center">
            <div class="md:w-1/2 mb-10 md:mb-0">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">Kesehatan Mental Anda <span class="text-green-500">Prioritas Kami</span></h1>
                <p class="text-lg text-gray-600 mb-8">Platform kesehatan mental terpercaya dengan psikolog profesional, komunitas yang mendukung, dan berbagai fitur untuk menjaga kesejahteraan mental Anda.</p>
                <div class="flex flex-wrap gap-4">
                    <button id="consultationBtn" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-full font-medium transition duration-300 flex items-center">
                        <i class="fas fa-calendar-check mr-2"></i> Buat Janji Konsultasi
                    </button>
                    <button class="border border-green-500 text-green-500 hover:bg-green-50 px-6 py-3 rounded-full font-medium transition duration-300 flex items-center">
                        <i class="fas fa-user-md mr-2"></i> Cari Psikolog
                    </button>
                </div>
            </div>
            <div class="md:w-1/2 flex justify-center">
                <div class="relative w-full max-w-md">
                    <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-brain text-green-500 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">Tes Kesehatan Mental</h3>
                                <p class="text-sm text-gray-500">Cek kondisi mental Anda sekarang</p>
                            </div>
                        </div>
                        <p class="text-gray-600 mb-4">Lakukan pengecekan kesehatan mental Anda dengan tes yang telah divalidasi oleh para ahli.</p>
                        <button id="quickTestBtn" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-medium transition duration-300">
                            Mulai Tes Sekarang
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Fitur Utama -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Layanan Kami</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Tes Kesehatan Mental -->
                <div class="bg-green-50 rounded-2xl p-6 card-hover">
                    <div class="w-14 h-14 bg-green-100 rounded-full flex items-center justify-center mb-4">
                        <i class="fas fa-clipboard-check text-green-500 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Tes Kesehatan Mental</h3>
                    <p class="text-gray-600 mb-4">Lakukan pengecekan kesehatan mental dengan tes yang telah divalidasi oleh para ahli.</p>
                    <a href="#tes" class="text-green-500 font-medium flex items-center">
                        Coba sekarang <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
                
                <!-- Komunitas -->
                <div class="bg-green-50 rounded-2xl p-6 card-hover">
                    <div class="w-14 h-14 bg-green-100 rounded-full flex items-center justify-center mb-4">
                        <i class="fas fa-users text-green-500 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Komunitas Support</h3>
                    <p class="text-gray-600 mb-4">Berbagi cerita dan pengalaman secara anonim dengan komunitas yang mendukung.</p>
                    <a href="#komunitas" class="text-green-500 font-medium flex items-center">
                        Jelajahi <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
                
                <!-- Konsultasi Psikolog -->
                <div class="bg-green-50 rounded-2xl p-6 card-hover">
                    <div class="w-14 h-14 bg-green-100 rounded-full flex items-center justify-center mb-4">
                        <i class="fas fa-user-md text-green-500 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Konsultasi Psikolog</h3>
                    <p class="text-gray-600 mb-4">Konsultasi dengan psikolog profesional via chat, telepon, atau video call.</p>
                    <a href="#konsultasi" class="text-green-500 font-medium flex items-center">
                        Buat Janji <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
                
                <!-- Meditasi -->
                <div class="bg-green-50 rounded-2xl p-6 card-hover">
                    <div class="w-14 h-14 bg-green-100 rounded-full flex items-center justify-center mb-4">
                        <i class="fas fa-spa text-green-500 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Meditasi & Relaksasi</h3>
                    <p class="text-gray-600 mb-4">Temukan ketenangan dengan panduan meditasi dan musik relaksasi.</p>
                    <a href="#meditasi" class="text-green-500 font-medium flex items-center">
                        Mulai Meditasi <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Misi Harian & Daily Login -->
    <section id="misi" class="py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">Misi Harian & Poin</h2>
            <p class="text-lg text-center text-gray-600 mb-12 max-w-2xl mx-auto">Selesaikan misi harian dan login setiap hari untuk mendapatkan poin yang dapat ditukarkan dengan konsultasi gratis.</p>
            
            <!-- Daily Login -->
            <div class="login-streak rounded-2xl p-6 mb-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Login Harian</h3>
                        <p class="text-gray-600">Login setiap hari untuk mendapatkan poin tambahan!</p>
                    </div>
                    <div class="flex items-center">
                        <div class="mr-4 text-center">
                            <div class="text-2xl font-bold text-amber-600" id="streakCount">0</div>
                            <div class="text-sm text-gray-600">Hari Berturut-turut</div>
                        </div>
                        <button id="dailyLoginBtn" class="bg-amber-500 hover:bg-amber-600 text-white px-6 py-3 rounded-full font-medium transition duration-300 flex items-center">
                            <i class="fas fa-calendar-day mr-2"></i> Login Hari Ini
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Misi Harian -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Misi akan diisi oleh JavaScript -->
            </div>
            
            <!-- Info Poin -->
            <div class="mt-12 bg-white rounded-2xl p-6 max-w-2xl mx-auto">
                <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">Cara Mendapatkan & Menggunakan Poin</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-bold text-gray-700 mb-2">Cara Mendapatkan Poin:</h4>
                        <ul class="text-gray-600 space-y-2">
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-500 mt-1 mr-2"></i>
                                <span>Login harian: 10 poin</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-500 mt-1 mr-2"></i>
                                <span>Menyelesaikan tes kesehatan: 25 poin</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-500 mt-1 mr-2"></i>
                                <span>Berbagi cerita di komunitas: 15 poin</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-500 mt-1 mr-2"></i>
                                <span>Meditasi selama 10 menit: 20 poin</span>
                            </li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-700 mb-2">Cara Menggunakan Poin:</h4>
                        <ul class="text-gray-600 space-y-2">
                            <li class="flex items-start">
                                <i class="fas fa-exchange-alt text-green-500 mt-1 mr-2"></i>
                                <span>Konsultasi gratis 2x per minggu</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-exchange-alt text-green-500 mt-1 mr-2"></i>
                                <span>Konsultasi tambahan: 100 poin/sesi</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Tes Kesehatan Mental -->
    <section id="tes" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Tes Kesehatan Mental</h2>
            <p class="text-lg text-center text-gray-600 mb-12 max-w-2xl mx-auto">Lakukan pengecekan kesehatan mental Anda dengan tes yang telah divalidasi oleh para ahli.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Tes Depresi -->
                <div class="bg-white rounded-2xl p-6 shadow-sm card-hover">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-2">Tes Depresi (PHQ-9)</h3>
                            <p class="text-gray-600 mb-4">Tes untuk mengevaluasi gejala depresi dalam 2 minggu terakhir.</p>
                        </div>
                        <div class="points-badge text-white px-3 py-1 rounded-full text-sm font-medium">
                            +25 Poin
                        </div>
                    </div>
                    <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition duration-300 start-test" data-test="phq9">
                        Mulai Tes
                    </button>
                </div>
                
                <!-- Tes Kecemasan -->
                <div class="bg-white rounded-2xl p-6 shadow-sm card-hover">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-2">Tes Kecemasan (GAD-7)</h3>
                            <p class="text-gray-600 mb-4">Tes untuk mengevaluasi tingkat kecemasan yang Anda alami.</p>
                        </div>
                        <div class="points-badge text-white px-3 py-1 rounded-full text-sm font-medium">
                            +25 Poin
                        </div>
                    </div>
                    <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition duration-300 start-test" data-test="gad7">
                        Mulai Tes
                    </button>
                </div>
            </div>
            
            <!-- Hasil Tes -->
            <div id="testResults" class="mt-12 bg-white rounded-2xl shadow-lg p-8 max-w-2xl mx-auto" style="display: none;">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Hasil Tes Terakhir</h3>
                <div class="flex justify-center mb-6">
                    <div class="relative w-40 h-40">
                        <svg class="w-full h-full" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="45" fill="none" stroke="#e5e7eb" stroke-width="10"/>
                            <circle id="scoreCircle" cx="50" cy="50" r="45" fill="none" stroke="#10b981" stroke-width="10" stroke-dasharray="283" stroke-dashoffset="70" stroke-linecap="round" transform="rotate(-90 50 50)"/>
                            <text id="scoreText" x="50" y="50" text-anchor="middle" dy="7" font-size="20" font-weight="bold" fill="#1f2937">75%</text>
                        </svg>
                    </div>
                </div>
                <p class="text-center text-gray-600 mb-2">Skor Kesehatan Mental Anda</p>
                <p id="scoreCategory" class="text-center text-green-500 font-medium mb-6">Baik</p>
                <div id="resultDetails" class="text-center text-gray-600 mb-6">
                    <!-- Detail hasil akan diisi oleh JavaScript -->
                </div>
                <button id="retakeTest" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-medium transition duration-300">
                    Ulangi Tes
                </button>
            </div>
        </div>
    </section>

    <!-- Komunitas -->
    <section id="komunitas" class="py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">Komunitas Support</h2>
            <p class="text-lg text-center text-gray-600 mb-12 max-w-2xl mx-auto">Berbagi cerita dan pengalaman secara anonim dengan komunitas yang saling mendukung.</p>
            
            <div id="communityPosts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                <!-- Post akan diisi oleh JavaScript -->
            </div>
            
            <div class="text-center">
                <button id="shareStoryBtn" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-full font-medium transition duration-300 flex items-center mx-auto">
                    <i class="fas fa-plus mr-2"></i> Bagikan Cerita Anda
                </button>
            </div>
        </div>
    </section>

    <!-- Konsultasi Psikolog -->
    <section id="konsultasi" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">Konsultasi dengan Psikolog</h2>
            <p class="text-lg text-center text-gray-600 mb-12 max-w-2xl mx-auto">Konsultasi dengan psikolog profesional via chat, telepon, atau video call sesuai kenyamanan Anda.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <!-- Psikolog akan diisi oleh JavaScript -->
            </div>
            
            <div class="text-center">
                <button class="border border-green-500 text-green-500 hover:bg-green-50 px-6 py-3 rounded-full font-medium transition duration-300">
                    Lihat Semua Psikolog
                </button>
            </div>
        </div>
    </section>

    <!-- Meditasi -->
    <section id="meditasi" class="py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">Meditasi & Relaksasi</h2>
            <p class="text-lg text-center text-gray-600 mb-12 max-w-2xl mx-auto">Temukan ketenangan dengan panduan meditasi dan musik relaksasi.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                <!-- Meditasi akan diisi oleh JavaScript -->
            </div>
            
            <div class="meditation-player rounded-2xl p-8 max-w-4xl mx-auto">
                <div class="flex flex-col md:flex-row items-center">
                    <div class="md:w-1/2 mb-6 md:mb-0">
                        <h3 class="text-2xl font-bold text-white mb-4">Musik Relaksasi</h3>
                        <p class="text-green-100 mb-4">Dengarkan koleksi musik relaksasi yang dirancang khusus untuk menenangkan pikiran dan mengurangi stres.</p>
                        <button id="playRelaxation" class="bg-white hover:bg-green-50 text-green-600 px-6 py-3 rounded-full font-medium transition duration-300 flex items-center">
                            <i class="fas fa-play mr-2"></i> Putar Sekarang
                        </button>
                    </div>
                    <div class="md:w-1/2 flex justify-center">
                        <div class="bg-white rounded-2xl p-6 shadow-md w-full max-w-xs">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 bg-green-200 rounded-full flex items-center justify-center mr-3">
                                    <i class="fas fa-music text-green-600"></i>
                                </div>
                                <div>
                                    <h4 id="trackTitle" class="font-bold text-gray-800">Suara Alam</h4>
                                    <p id="trackDesc" class="text-sm text-gray-500">Hujan & Burung</p>
                                </div>
                            </div>
                            <div class="mb-4">
                                <div class="h-1 bg-gray-200 rounded-full">
                                    <div id="progressBar" class="h-1 bg-green-500 rounded-full w-0"></div>
                                </div>
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span id="currentTime">0:00</span>
                                    <span id="totalTime">0:00</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <button id="prevTrack" class="text-gray-500 hover:text-green-500">
                                    <i class="fas fa-step-backward"></i>
                                </button>
                                <button id="playPause" class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white">
                                    <i class="fas fa-play"></i>
                                </button>
                                <button id="nextTrack" class="text-gray-500 hover:text-green-500">
                                    <i class="fas fa-step-forward"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-green-800 text-white pt-12 pb-6">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
                <div>
                    <div class="flex items-center mb-4">
                        <div class="lotus-logo mr-3">
                            <div class="lotus-petal"></div>
                            <div class="lotus-petal"></div>
                            <div class="lotus-petal"></div>
                            <div class="lotus-petal"></div>
                            <div class="lotus-petal"></div>
                            <div class="lotus-petal"></div>
                            <div class="lotus-petal"></div>
                            <div class="lotus-petal"></div>
                            <div class="lotus-center"></div>
                        </div>
                        <h2 class="text-2xl font-bold">Bloom</h2>
                    </div>
                    <p class="text-green-200 mb-4">Platform kesehatan mental terpercaya dengan psikolog profesional dan komunitas yang mendukung.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-green-200 hover:text-white">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="text-green-200 hover:text-white">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="text-green-200 hover:text-white">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-bold mb-4">Layanan</h3>
                    <ul class="space-y-2">
                        <li><a href="#tes" class="text-green-200 hover:text-white">Tes Kesehatan Mental</a></li>
                        <li><a href="#komunitas" class="text-green-200 hover:text-white">Komunitas</a></li>
                        <li><a href="#konsultasi" class="text-green-200 hover:text-white">Konsultasi Psikolog</a></li>
                        <li><a href="#meditasi" class="text-green-200 hover:text-white">Meditasi & Relaksasi</a></li>
                        <li><a href="#misi" class="text-green-200 hover:text-white">Misi Harian</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-bold mb-4">Bantuan</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-green-200 hover:text-white">FAQ</a></li>
                        <li><a href="#" class="text-green-200 hover:text-white">Kebijakan Privasi</a></li>
                        <li><a href="#" class="text-green-200 hover:text-white">Syarat & Ketentuan</a></li>
                        <li><a href="#" class="text-green-200 hover:text-white">Kontak Kami</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-bold mb-4">Download Aplikasi</h3>
                    <p class="text-green-200 mb-4">Dapatkan pengalaman terbaik dengan aplikasi mobile kami.</p>
                    <div class="flex space-x-2">
                        <button class="bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg flex items-center">
                            <i class="fab fa-apple mr-2"></i> App Store
                        </button>
                        <button class="bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg flex items-center">
                            <i class="fab fa-google-play mr-2"></i> Play Store
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-green-700 pt-6 text-center text-green-300">
                <p>&copy; 2023 Bloom. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Modal untuk Tes Kesehatan Mental -->
    <div id="testModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 id="testTitle" class="text-xl font-bold text-gray-800">Tes Kesehatan Mental</h3>
                <button id="closeTestModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="mb-4">
                <div class="progress-bar">
                    <div id="testProgress" class="progress-fill" style="width: 0%"></div>
                </div>
                <p id="testQuestionCounter" class="text-sm text-gray-500 mt-2 text-right">Pertanyaan 0/10</p>
            </div>
            <div id="testQuestion" class="mb-6">
                <!-- Pertanyaan akan diisi oleh JavaScript -->
            </div>
            <div id="testOptions" class="space-y-3">
                <!-- Opsi jawaban akan diisi oleh JavaScript -->
            </div>
            <div class="flex justify-between mt-6">
                <button id="prevQuestion" class="text-green-500 hover:text-green-700 font-medium" style="display: none;">
                    <i class="fas fa-arrow-left mr-2"></i> Sebelumnya
                </button>
                <button id="nextQuestion" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium ml-auto">
                    Selanjutnya
                </button>
            </div>
        </div>
    </div>

    <!-- Modal untuk Berbagi Cerita -->
    <div id="shareStoryModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">Bagikan Cerita Anda</h3>
                <button id="closeShareModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="mb-4">
                <textarea id="storyText" class="w-full h-40 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Bagikan pengalaman atau perasaan Anda di sini..."></textarea>
            </div>
            <div class="flex justify-end">
                <button id="cancelStory" class="text-gray-500 hover:text-gray-700 font-medium mr-4">
                    Batal
                </button>
                <button id="submitStory" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium">
                    Bagikan
                </button>
            </div>
        </div>
    </div>

    <!-- Modal untuk Konsultasi -->
    <div id="consultationModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 id="consultationTitle" class="text-xl font-bold text-gray-800">Buat Janji Konsultasi</h3>
                <button id="closeConsultationModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="consultationForm">
                <!-- Form konsultasi akan diisi oleh JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Data untuk aplikasi
        const appData = {
            currentUser: null,
            testResults: JSON.parse(localStorage.getItem('testResults')) || [],
            communityPosts: JSON.parse(localStorage.getItem('communityPosts')) || [
                {
                    id: 1,
                    content: "Hari ini aku berhasil bangun dari tempat tidur meski berat sekali. Rasanya seperti kemenangan kecil.",
                    likes: 24,
                    comments: 8,
                    timestamp: "2 jam yang lalu"
                },
                {
                    id: 2,
                    content: "Baru saja menyelesaikan sesi meditasi pertama setelah sekian lama. Rasanya lega sekali.",
                    likes: 42,
                    comments: 12,
                    timestamp: "5 jam yang lalu"
                },
                {
                    id: 3,
                    content: "Terima kasih untuk semua yang telah memberikan dukungan di sini. Membaca cerita kalian membuatku merasa tidak sendirian.",
                    likes: 67,
                    comments: 15,
                    timestamp: "1 hari yang lalu"
                }
            ],
            psychologists: [
                {
                    id: 1,
                    name: "Dr. Sari Indah, M.Psi.",
                    specialty: "Psikolog Klinis",
                    description: "Spesialisasi: Depresi, Kecemasan, dan Gangguan Mood",
                    rating: 4.9,
                    consultations: 1200
                },
                {
                    id: 2,
                    name: "Dr. Andi Pratama, M.Psi.",
                    specialty: "Psikolog Klinis",
                    description: "Spesialisasi: Trauma, PTSD, dan Konseling Keluarga",
                    rating: 4.8,
                    consultations: 980
                },
                {
                    id: 3,
                    name: "Dr. Maya Sari, M.Psi., Psikolog",
                    specialty: "Psikolog Anak & Remaja",
                    description: "Spesialisasi: Masalah Perkembangan, ADHD, dan Bullying",
                    rating: 4.9,
                    consultations: 1500
                }
            ],
            meditations: [
                {
                    id: 1,
                    title: "Meditasi Pernapasan",
                    description: "Panduan meditasi 10 menit untuk menenangkan pikiran.",
                    duration: "10 menit",
                    icon: "spa",
                    points: 20
                },
                {
                    id: 2,
                    title: "Tidur Nyenyak",
                    description: "Meditasi panduan untuk meningkatkan kualitas tidur.",
                    duration: "15 menit",
                    icon: "bed",
                    points: 20
                },
                {
                    id: 3,
                    title: "Redakan Kecemasan",
                    description: "Teknik relaksasi untuk meredakan serangan kecemasan.",
                    duration: "12 menit",
                    icon: "wind",
                    points: 20
                },
                {
                    id: 4,
                    title: "Mindfulness Harian",
                    description: "Latihan mindfulness untuk meningkatkan kesadaran.",
                    duration: "8 menit",
                    icon: "mountain",
                    points: 20
                }
            ],
            relaxationTracks: [
                {
                    id: 1,
                    title: "Suara Alam",
                    description: "Hujan & Burung",
                    duration: 300 // 5 menit dalam detik
                },
                {
                    id: 2,
                    title: "Gelombang Samudra",
                    description: "Ombak & Angin Laut",
                    duration: 420 // 7 menit dalam detik
                },
                {
                    id: 3,
                    title: "Hutan yang Tenang",
                    description: "Kicau Burung & Daun Bergemerisik",
                    duration: 360 // 6 menit dalam detik
                }
            ],
            currentTrack: 0,
            isPlaying: false,
            currentTime: 0,
            timerInterval: null,
            
            // Data untuk tes kesehatan mental
            tests: {
                phq9: {
                    title: "Tes Depresi (PHQ-9)",
                    questions: [
                        "Seberapa sering Anda merasa sedikit minat atau kesenangan dalam melakukan sesuatu?",
                        "Seberapa sering Anda merasa down, depresi, atau putus asa?",
                        "Seberapa sering Anda mengalami kesulitan tidur atau tidur terlalu banyak?",
                        "Seberapa sering Anda merasa lelah atau memiliki sedikit energi?",
                        "Seberapa sering Anda memiliki nafsu makan yang buruk atau berlebihan?",
                        "Seberapa sering Anda merasa buruk tentang diri sendiri - atau bahwa Anda adalah seorang yang gagal atau telah mengecewakan diri sendiri atau keluarga Anda?",
                        "Seberapa sering Anda mengalami kesulitan berkonsentrasi pada hal-hal, seperti membaca korran atau menonton televisi?",
                        "Seberapa sering Anda bergerak atau berbicara sangat lambat sehingga orang lain mungkin memperhatikannya? Atau sebaliknya - sangat gelisah atau resah sehingga Anda bergerak lebih banyak dari biasanya?",
                        "Seberapa sering Anda memiliki pikiran bahwa Anda akan lebih baik mati atau melukai diri sendiri dengan cara tertentu?"
                    ],
                    options: [
                        "Tidak sama sekali",
                        "Beberapa hari",
                        "Lebih dari setengah hari",
                        "Hampir setiap hari"
                    ],
                    points: 25
                },
                gad7: {
                    title: "Tes Kecemasan (GAD-7)",
                    questions: [
                        "Seberapa sering Anda merasa gelisah, gugup, atau tegang?",
                        "Seberapa sering Anda tidak dapat menghentikan atau mengendalikan kekhawatiran?",
                        "Seberapa sering Anda mengkhawatirkan terlalu banyak tentang berbagai hal?",
                        "Seberapa sering Anda mengalami kesulitan untuk bersantai?",
                        "Seberapa sering Anda merasa sangat gelisah sehingga sulit untuk duduk diam?",
                        "Seberapa sering Anda menjadi mudah kesal atau marah?",
                        "Seberapa sering Anda merasa takut seolah-olah sesuatu yang mengerikan akan terjadi?"
                    ],
                    options: [
                        "Tidak sama sekali",
                        "Beberapa hari",
                        "Lebih dari setengah hari",
                        "Hampir setiap hari"
                    ],
                    points: 25
                }
            },
            currentTest: null,
            currentQuestionIndex: 0,
            testAnswers: [],
            
            // Data untuk misi harian dan poin
            dailyMissions: [
                {
                    id: 1,
                    title: "Login Harian",
                    description: "Login ke aplikasi setiap hari",
                    icon: "calendar-day",
                    points: 10,
                    completed: false
                },
                {
                    id: 2,
                    title: "Tes Kesehatan Mental",
                    description: "Selesaikan salah satu tes kesehatan mental",
                    icon: "clipboard-check",
                    points: 25,
                    completed: false
                },
                {
                    id: 3,
                    title: "Berbagi Cerita",
                    description: "Bagikan cerita atau pengalaman di komunitas",
                    icon: "users",
                    points: 15,
                    completed: false
                },
                {
                    id: 4,
                    title: "Meditasi 10 Menit",
                    description: "Lakukan meditasi selama minimal 10 menit",
                    icon: "spa",
                    points: 20,
                    completed: false
                }
            ],
            userPoints: parseInt(localStorage.getItem('userPoints')) || 0,
            loginStreak: parseInt(localStorage.getItem('loginStreak')) || 0,
            lastLoginDate: localStorage.getItem('lastLoginDate') || null,
            weeklyConsultations: parseInt(localStorage.getItem('weeklyConsultations')) || 0,
            lastConsultationReset: localStorage.getItem('lastConsultationReset') || null
        };

        // Inisialisasi aplikasi
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            renderCommunityPosts();
            renderPsychologists();
            renderMeditations();
            renderDailyMissions();
            updatePointsDisplay();
            updateLoginStreak();
            checkWeeklyReset();
        });

        function initializeApp() {
            // Cek apakah pengguna sudah login
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                appData.currentUser = JSON.parse(savedUser);
                updateLoginState();
            }
            
            // Periksa apakah perlu reset konsultasi mingguan
            checkWeeklyReset();
        }

        function setupEventListeners() {
            // Navigasi
            const navLinks = document.querySelectorAll('nav a');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetSection = document.getElementById(targetId);
                    if (targetSection) {
                        window.scrollTo({
                            top: targetSection.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Notifikasi positif
            setTimeout(function() {
                const notification = document.querySelector('.fixed.top-20');
                if (notification) {
                    notification.style.display = 'none';
                }
            }, 5000);

            // Tes kesehatan mental
            const startTestButtons = document.querySelectorAll('.start-test');
            startTestButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const testType = this.getAttribute('data-test');
                    startTest(testType);
                });
            });

            // Modal tes
            document.getElementById('closeTestModal').addEventListener('click', closeTestModal);
            document.getElementById('prevQuestion').addEventListener('click', prevQuestion);
            document.getElementById('nextQuestion').addEventListener('click', nextQuestion);

            // Berbagi cerita
            document.getElementById('shareStoryBtn').addEventListener('click', openShareStoryModal);
            document.getElementById('closeShareModal').addEventListener('click', closeShareStoryModal);
            document.getElementById('cancelStory').addEventListener('click', closeShareStoryModal);
            document.getElementById('submitStory').addEventListener('click', submitStory);

            // Konsultasi
            document.getElementById('consultationBtn').addEventListener('click', openConsultationModal);
            document.getElementById('quickTestBtn').addEventListener('click', function() {
                startTest('phq9');
            });
            document.getElementById('closeConsultationModal').addEventListener('click', closeConsultationModal);

            // Meditasi
            document.getElementById('playPause').addEventListener('click', togglePlayPause);
            document.getElementById('prevTrack').addEventListener('click', prevTrack);
            document.getElementById('nextTrack').addEventListener('click', nextTrack);
            document.getElementById('playRelaxation').addEventListener('click', playRelaxation);

            // Ulangi tes
            document.getElementById('retakeTest').addEventListener('click', function() {
                document.getElementById('testResults').style.display = 'none';
            });

            // Daily Login
            document.getElementById('dailyLoginBtn').addEventListener('click', processDailyLogin);
        }

        function updateLoginState() {
            const loginBtn = document.getElementById('loginBtn');
            const registerBtn = document.getElementById('registerBtn');
            const pointsDisplay = document.getElementById('pointsDisplay');
            
            if (appData.currentUser) {
                loginBtn.textContent = appData.currentUser.name;
                registerBtn.textContent = 'Keluar';
                registerBtn.onclick = logout;
                pointsDisplay.classList.remove('hidden');
            } else {
                loginBtn.textContent = 'Masuk';
                registerBtn.textContent = 'Daftar';
                registerBtn.onclick = openRegisterModal;
                pointsDisplay.classList.add('hidden');
            }
        }

        function logout() {
            appData.currentUser = null;
            localStorage.removeItem('currentUser');
            updateLoginState();
            alert('Anda telah berhasil keluar.');
        }

        function processDailyLogin() {
            if (!appData.currentUser) {
                alert('Silakan login terlebih dahulu untuk mendapatkan poin harian.');
                return;
            }
            
            const today = new Date().toDateString();
            
            // Jika sudah login hari ini
            if (appData.lastLoginDate === today) {
                alert('Anda sudah login hari ini. Kembi besok untuk mendapatkan poin lagi!');
                return;
            }
            
            // Update streak login
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (appData.lastLoginDate === yesterday.toDateString()) {
                appData.loginStreak += 1;
            } else {
                appData.loginStreak = 1;
            }
            
            // Tambahkan poin
            addPoints(10, 'Login Harian');
            
            // Update data
            appData.lastLoginDate = today;
            localStorage.setItem('lastLoginDate', appData.lastLoginDate);
            localStorage.setItem('loginStreak', appData.loginStreak.toString());
            
            // Update tampilan
            updateLoginStreak();
            updatePointsDisplay();
            
            // Tandai misi sebagai selesai
            completeMission(1);
            
            alert(`Selamat! Anda mendapatkan 10 poin untuk login hari ini.\nStreak login Anda: ${appData.loginStreak} hari berturut-turut.`);
        }

        function updateLoginStreak() {
            document.getElementById('streakCount').textContent = appData.loginStreak;
        }

        function renderDailyMissions() {
            const container = document.querySelector('#misi .grid');
            container.innerHTML = '';
            
            appData.dailyMissions.forEach(mission => {
                const missionElement = document.createElement('div');
                missionElement.className = 'bg-white rounded-2xl p-6 shadow-sm card-hover';
                missionElement.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-${mission.icon} text-green-500 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-800">${mission.title}</h3>
                                <p class="text-sm text-gray-600">${mission.description}</p>
                            </div>
                        </div>
                        <div class="points-badge text-white px-3 py-1 rounded-full text-sm font-medium">
                            +${mission.points} Poin
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <div class="flex items-center ${mission.completed ? 'text-green-500' : 'text-gray-500'}">
                            <i class="fas ${mission.completed ? 'fa-check-circle' : 'fa-circle'} mr-2"></i>
                            <span>${mission.completed ? 'Selesai' : 'Belum Selesai'}</span>
                        </div>
                        <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition duration-300 ${mission.completed ? 'opacity-50 cursor-not-allowed' : ''}" 
                                ${mission.completed ? 'disabled' : ''}
                                onclick="completeMission(${mission.id})">
                            ${mission.completed ? 'Selesai' : 'Tandai Selesai'}
                        </button>
                    </div>
                `;
                container.appendChild(missionElement);
            });
        }

        function completeMission(missionId) {
            if (!appData.currentUser) {
                alert('Silakan login terlebih dahulu untuk menyelesaikan misi.');
                return;
            }
            
            const mission = appData.dailyMissions.find(m => m.id === missionId);
            
            if (mission && !mission.completed) {
                mission.completed = true;
                addPoints(mission.points, mission.title);
                renderDailyMissions();
                
                // Simpan status misi ke localStorage
                localStorage.setItem('dailyMissions', JSON.stringify(appData.dailyMissions));
            }
        }

        function addPoints(points, reason) {
            appData.userPoints += points;
            localStorage.setItem('userPoints', appData.userPoints.toString());
            updatePointsDisplay();
            
            // Tampilkan notifikasi poin
            showPointsNotification(points, reason);
        }

        function updatePointsDisplay() {
            document.getElementById('pointsValue').textContent = appData.userPoints;
        }

        function showPointsNotification(points, reason) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-20 right-6 z-50 bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded-lg shadow-md max-w-sm';
            notification.innerHTML = `
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-coins text-green-500"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium">+${points} Poin!</p>
                        <p class="text-xs">${reason}</p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function startTest(testType) {
            if (!appData.currentUser) {
                alert('Silakan login terlebih dahulu untuk melakukan tes kesehatan mental.');
                return;
            }
            
            appData.currentTest = testType;
            appData.currentQuestionIndex = 0;
            appData.testAnswers = [];
            
            const test = appData.tests[testType];
            document.getElementById('testTitle').textContent = test.title;
            document.getElementById('testProgress').style.width = '0%';
            document.getElementById('testQuestionCounter').textContent = `Pertanyaan 1/${test.questions.length}`;
            
            showQuestion();
            document.getElementById('testModal').style.display = 'flex';
        }

        function showQuestion() {
            const test = appData.tests[appData.currentTest];
            const questionIndex = appData.currentQuestionIndex;
            const question = test.questions[questionIndex];
            
            document.getElementById('testQuestion').innerHTML = `<p class="text-lg text-gray-800">${question}</p>`;
            
            const optionsContainer = document.getElementById('testOptions');
            optionsContainer.innerHTML = '';
            
            test.options.forEach((option, index) => {
                const optionElement = document.createElement('button');
                optionElement.className = 'w-full text-left p-3 border border-gray-300 rounded-lg hover:bg-green-50 transition duration-300';
                optionElement.textContent = option;
                optionElement.addEventListener('click', () => selectAnswer(index));
                
                // Tandai jawaban yang sudah dipilih
                if (appData.testAnswers[questionIndex] === index) {
                    optionElement.classList.add('bg-green-100', 'border-green-500');
                }
                
                optionsContainer.appendChild(optionElement);
            });
            
            // Update progress bar
            const progress = ((questionIndex + 1) / test.questions.length) * 100;
            document.getElementById('testProgress').style.width = `${progress}%`;
            document.getElementById('testQuestionCounter').textContent = `Pertanyaan ${questionIndex + 1}/${test.questions.length}`;
            
            // Tampilkan/tutup tombol sebelumnya
            document.getElementById('prevQuestion').style.display = questionIndex > 0 ? 'block' : 'none';
            
            // Ubah teks tombol selanjutnya jika ini adalah pertanyaan terakhir
            document.getElementById('nextQuestion').textContent = questionIndex === test.questions.length - 1 ? 'Selesai' : 'Selanjutnya';
        }

        function selectAnswer(answerIndex) {
            appData.testAnswers[appData.currentQuestionIndex] = answerIndex;
            showQuestion(); // Refresh untuk menampilkan pilihan yang dipilih
        }

        function prevQuestion() {
            if (appData.currentQuestionIndex > 0) {
                appData.currentQuestionIndex--;
                showQuestion();
            }
        }

        function nextQuestion() {
            const test = appData.tests[appData.currentTest];
            
            // Pastikan pengguna telah memilih jawaban
            if (appData.testAnswers[appData.currentQuestionIndex] === undefined) {
                alert('Silakan pilih jawaban sebelum melanjutkan.');
                return;
            }
            
            if (appData.currentQuestionIndex < test.questions.length - 1) {
                appData.currentQuestionIndex++;
                showQuestion();
            } else {
                finishTest();
            }
        }

        function finishTest() {
            const test = appData.tests[appData.currentTest];
            let score = 0;
            
            // Hitung skor (setiap jawaban bernilai 0-3)
            appData.testAnswers.forEach(answer => {
                score += answer;
            });
            
            // Normalisasi skor ke persentase (0-100)
            const maxScore = (test.options.length - 1) * test.questions.length;
            const percentage = 100 - (score / maxScore) * 100;
            
            // Simpan hasil tes
            const testResult = {
                testType: appData.currentTest,
                testName: test.title,
                score: percentage,
                date: new Date().toLocaleDateString('id-ID'),
                answers: [...appData.testAnswers]
            };
            
            appData.testResults.push(testResult);
            localStorage.setItem('testResults', JSON.stringify(appData.testResults));
            
            // Tambahkan poin untuk menyelesaikan tes
            addPoints(test.points, test.title);
            
            // Tandai misi sebagai selesai
            completeMission(2);
            
            closeTestModal();
            updateTestResults();
            document.getElementById('testResults').style.display = 'block';
            
            // Scroll ke hasil tes
            document.getElementById('tes').scrollIntoView({ behavior: 'smooth' });
        }

        function updateTestResults() {
            if (appData.testResults.length > 0) {
                const latestResult = appData.testResults[appData.testResults.length - 1];
                const score = Math.round(latestResult.score);
                
                // Update lingkaran skor
                const circumference = 283; // 2 *  * 45
                const offset = circumference - (score / 100) * circumference;
                document.getElementById('scoreCircle').style.strokeDashoffset = offset;
                document.getElementById('scoreText').textContent = `${score}%`;
                
                // Tentukan kategori
                let category, color;
                if (score >= 80) {
                    category = "Sangat Baik";
                    color = "text-green-500";
                } else if (score >= 60) {
                    category = "Baik";
                    color = "text-green-400";
                } else if (score >= 40) {
                    category = "Cukup";
                    color = "text-yellow-500";
                } else {
                    category = "Perlu Perhatian";
                    color = "text-red-500";
                }
                
                document.getElementById('scoreCategory').textContent = category;
                document.getElementById('scoreCategory').className = `text-center ${color} font-medium mb-6`;
                
                // Update detail hasil
                const details = `
                    <p>Jenis Tes: ${latestResult.testName}</p>
                    <p>Tanggal: ${latestResult.date}</p>
                `;
                document.getElementById('resultDetails').innerHTML = details;
            }
        }

        function closeTestModal() {
            document.getElementById('testModal').style.display = 'none';
        }

        function renderCommunityPosts() {
            const container = document.getElementById('communityPosts');
            container.innerHTML = '';
            
            appData.communityPosts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'bg-green-50 rounded-2xl p-6 card-hover';
                postElement.innerHTML = `
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-green-200 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-user-secret text-green-600"></i>
                        </div>
                        <div>
                            <h3 class="font-medium text-gray-800">Pengguna Anonim</h3>
                            <p class="text-xs text-gray-500">${post.timestamp}</p>
                        </div>
                    </div>
                    <p class="text-gray-700 mb-4">${post.content}</p>
                    <div class="flex text-gray-500 text-sm">
                        <div class="flex items-center mr-4">
                            <i class="far fa-heart mr-1"></i> ${post.likes}
                        </div>
                        <div class="flex items-center">
                            <i class="far fa-comment mr-1"></i> ${post.comments}
                        </div>
                    </div>
                `;
                container.appendChild(postElement);
            });
        }

        function openShareStoryModal() {
            if (!appData.currentUser) {
                alert('Silakan login terlebih dahulu untuk berbagi cerita.');
                return;
            }
            
            document.getElementById('shareStoryModal').style.display = 'flex';
        }

        function closeShareStoryModal() {
            document.getElementById('shareStoryModal').style.display = 'none';
            document.getElementById('storyText').value = '';
        }

        function submitStory() {
            const storyText = document.getElementById('storyText').value.trim();
            
            if (!storyText) {
                alert('Silakan tulis cerita Anda sebelum membagikannya.');
                return;
            }
            
            const newPost = {
                id: appData.communityPosts.length + 1,
                content: storyText,
                likes: 0,
                comments: 0,
                timestamp: 'Baru saja'
            };
            
            appData.communityPosts.unshift(newPost);
            localStorage.setItem('communityPosts', JSON.stringify(appData.communityPosts));
            
            // Tambahkan poin untuk berbagi cerita
            addPoints(15, 'Berbagi Cerita');
            
            // Tandai misi sebagai selesai
            completeMission(3);
            
            renderCommunityPosts();
            closeShareStoryModal();
            alert('Cerita Anda telah berhasil dibagikan!');
        }

        function renderPsychologists() {
            const container = document.querySelector('#konsultasi .grid');
            container.innerHTML = '';
            
            appData.psychologists.forEach(psychologist => {
                const psychologistElement = document.createElement('div');
                psychologistElement.className = 'bg-white rounded-2xl shadow-lg overflow-hidden card-hover';
                psychologistElement.innerHTML = `
                    <div class="h-40 bg-green-100 flex items-center justify-center">
                        <div class="w-24 h-24 bg-green-200 rounded-full flex items-center justify-center">
                            <i class="fas fa-user-md text-green-600 text-3xl"></i>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-1">${psychologist.name}</h3>
                        <p class="text-green-500 font-medium mb-3">${psychologist.specialty}</p>
                        <p class="text-gray-600 mb-4">${psychologist.description}</p>
                        <div class="flex items-center text-gray-500 mb-4">
                            <i class="fas fa-star text-yellow-400 mr-1"></i>
                            <span class="font-medium">${psychologist.rating}</span>
                            <span class="mx-1"></span>
                            <span>${psychologist.consultations} konsultasi</span>
                        </div>
                        <button class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-medium transition duration-300 book-consultation" data-id="${psychologist.id}">
                            Buat Janji
                        </button>
                    </div>
                `;
                container.appendChild(psychologistElement);
            });
            
            // Tambahkan event listener untuk tombol buat janji
            const bookButtons = document.querySelectorAll('.book-consultation');
            bookButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const psychologistId = this.getAttribute('data-id');
                    openConsultationModal(psychologistId);
                });
            });
        }

        function openConsultationModal(psychologistId = null) {
            if (!appData.currentUser) {
                alert('Silakan login terlebih dahulu untuk membuat janji konsultasi.');
                return;
            }
            
            let psychologist = null;
            if (psychologistId) {
                psychologist = appData.psychologists.find(p => p.id == psychologistId);
            }
            
            document.getElementById('consultationTitle').textContent = psychologist 
                ? `Konsultasi dengan ${psychologist.name}` 
                : 'Buat Janji Konsultasi';
            
            // Cek apakah masih ada kuota konsultasi gratis minggu ini
            const consultationCost = appData.weeklyConsultations < 2 ? 0 : 100;
            const consultationText = consultationCost === 0 
                ? 'Konsultasi Gratis (Kuota mingguan)' 
                : `Konsultasi (${consultationCost} Poin)`;
            
            const formHtml = `
                <div class="mb-4">
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded mb-4">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-info-circle text-blue-500"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-blue-700">
                                    ${appData.weeklyConsultations < 2 
                                        ? `Anda memiliki ${2 - appData.weeklyConsultations} konsultasi gratis minggu ini.` 
                                        : 'Kuota konsultasi gratis minggu ini sudah habis. Konsultasi berikutnya memerlukan 100 poin.'}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="consultationType">Jenis Konsultasi</label>
                    <select id="consultationType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        <option value="chat">Chat</option>
                        <option value="telepon">Telepon</option>
                        <option value="video">Video Call</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="consultationDate">Tanggal Konsultasi</label>
                    <input type="date" id="consultationDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="consultationTime">Waktu Konsultasi</label>
                    <select id="consultationTime" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        <option value="09:00">09:00</option>
                        <option value="10:00">10:00</option>
                        <option value="11:00">11:00</option>
                        <option value="13:00">13:00</option>
                        <option value="14:00">14:00</option>
                        <option value="15:00">15:00</option>
                        <option value="16:00">16:00</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="consultationIssue">Masalah yang Ingin Didiskusikan</label>
                    <textarea id="consultationIssue" class="w-full h-32 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Jelaskan secara singkat masalah yang ingin Anda diskusikan..."></textarea>
                </div>
                <div class="flex justify-between items-center mb-4">
                    <span class="text-gray-700 font-medium">Biaya Konsultasi:</span>
                    <span class="font-bold ${consultationCost === 0 ? 'text-green-500' : 'text-amber-500'}">${consultationText}</span>
                </div>
                <div class="flex justify-end">
                    <button id="cancelConsultation" class="text-gray-500 hover:text-gray-700 font-medium mr-4">
                        Batal
                    </button>
                    <button id="submitConsultation" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium">
                        Buat Janji
                    </button>
                </div>
            `;
            
            document.getElementById('consultationForm').innerHTML = formHtml;
            document.getElementById('consultationModal').style.display = 'flex';
            
            // Set tanggal minimum ke hari ini
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('consultationDate').min = today;
            
            // Event listeners untuk form konsultasi
            document.getElementById('cancelConsultation').addEventListener('click', closeConsultationModal);
            document.getElementById('submitConsultation').addEventListener('click', function() {
                submitConsultation(consultationCost);
            });
        }

        function closeConsultationModal() {
            document.getElementById('consultationModal').style.display = 'none';
        }

        function submitConsultation(cost) {
            const type = document.getElementById('consultationType').value;
            const date = document.getElementById('consultationDate').value;
            const time = document.getElementById('consultationTime').value;
            const issue = document.getElementById('consultationIssue').value;
            
            if (!date || !issue) {
                alert('Silakan lengkapi semua field yang diperlukan.');
                return;
            }
            
            // Jika ada biaya, periksa apakah pengguna memiliki cukup poin
            if (cost > 0 && appData.userPoints < cost) {
                alert(`Poin Anda tidak cukup. Diperlukan ${cost} poin untuk konsultasi ini. Anda memiliki ${appData.userPoints} poin.`);
                return;
            }
            
            // Kurangi poin jika ada biaya
            if (cost > 0) {
                appData.userPoints -= cost;
                localStorage.setItem('userPoints', appData.userPoints.toString());
                updatePointsDisplay();
            }
            
            // Tambah jumlah konsultasi mingguan
            appData.weeklyConsultations++;
            localStorage.setItem('weeklyConsultations', appData.weeklyConsultations.toString());
            
            alert(`Janji konsultasi berhasil dibuat!\n\nJenis: ${type}\nTanggal: ${date}\nWaktu: ${time}\n${cost > 0 ? `Biaya: ${cost} poin\n` : ''}\nKami akan mengirimkan konfirmasi melalui email.`);
            closeConsultationModal();
        }

        function checkWeeklyReset() {
            const now = new Date();
            const lastReset = appData.lastConsultationReset ? new Date(appData.lastConsultationReset) : null;
            
            // Reset setiap Senin
            if (!lastReset || (now.getDay() === 1 && now.toDateString() !== lastReset.toDateString())) {
                appData.weeklyConsultations = 0;
                appData.lastConsultationReset = now.toISOString();
                localStorage.setItem('weeklyConsultations', '0');
                localStorage.setItem('lastConsultationReset', appData.lastConsultationReset);
            }
        }

        function renderMeditations() {
            const container = document.querySelector('#meditasi .grid');
            container.innerHTML = '';
            
            appData.meditations.forEach(meditation => {
                const meditationElement = document.createElement('div');
                meditationElement.className = 'bg-green-50 rounded-2xl overflow-hidden card-hover';
                meditationElement.innerHTML = `
                    <div class="h-40 bg-green-200 flex items-center justify-center">
                        <i class="fas fa-${meditation.icon} text-green-600 text-4xl"></i>
                    </div>
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-gray-800">${meditation.title}</h3>
                            <div class="points-badge text-white px-2 py-1 rounded-full text-xs font-medium">
                                +${meditation.points} Poin
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">${meditation.description}</p>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-500 text-sm">${meditation.duration}</span>
                            <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-1 rounded-full text-sm font-medium transition duration-300 start-meditation" data-id="${meditation.id}">
                                Mulai
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(meditationElement);
            });
            
            // Event listeners untuk meditasi
            const startButtons = document.querySelectorAll('.start-meditation');
            startButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const meditationId = this.getAttribute('data-id');
                    startMeditation(meditationId);
                });
            });
        }

        function startMeditation(meditationId) {
            if (!appData.currentUser) {
                alert('Silakan login terlebih dahulu untuk memulai meditasi.');
                return;
            }
            
            const meditation = appData.meditations.find(m => m.id == meditationId);
            
            // Simulasi timer meditasi
            alert(`Memulai meditasi: ${meditation.title}\n\nDurasi: ${meditation.duration}\n\nNikmati sesi meditasi Anda!`);
            
            // Setelah meditasi selesai, berikan poin
            setTimeout(() => {
                addPoints(meditation.points, meditation.title);
                
                // Tandai misi sebagai selesai
                completeMission(4);
                
                alert(`Sesi meditasi selesai! Anda mendapatkan ${meditation.points} poin.`);
            }, 1000); // Simulasi waktu meditasi
        }

        function playRelaxation() {
            appData.currentTrack = 0;
            loadTrack(appData.currentTrack);
            togglePlayPause();
        }

        function loadTrack(trackIndex) {
            const track = appData.relaxationTracks[trackIndex];
            document.getElementById('trackTitle').textContent = track.title;
            document.getElementById('trackDesc').textContent = track.description;
            document.getElementById('totalTime').textContent = formatTime(track.duration);
            
            appData.currentTime = 0;
            updateProgressBar();
        }

        function togglePlayPause() {
            const playPauseBtn = document.getElementById('playPause');
            
            if (appData.isPlaying) {
                // Jeda
                appData.isPlaying = false;
                clearInterval(appData.timerInterval);
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            } else {
                // Putar
                appData.isPlaying = true;
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                
                // Jika belum ada trek yang dimuat, muat trek pertama
                if (appData.currentTrack === null) {
                    appData.currentTrack = 0;
                    loadTrack(appData.currentTrack);
                }
                
                // Mulai timer
                appData.timerInterval = setInterval(() => {
                    appData.currentTime++;
                    updateProgressBar();
                    
                    // Jika sudah mencapai akhir trek, lanjut ke trek berikutnya
                    if (appData.currentTime >= appData.relaxationTracks[appData.currentTrack].duration) {
                        nextTrack();
                    }
                }, 1000);
            }
        }

        function prevTrack() {
            if (appData.currentTrack > 0) {
                appData.currentTrack--;
                loadTrack(appData.currentTrack);
                if (appData.isPlaying) {
                    // Jika sedang diputar, mulai trek baru
                    clearInterval(appData.timerInterval);
                    appData.timerInterval = setInterval(() => {
                        appData.currentTime++;
                        updateProgressBar();
                        
                        if (appData.currentTime >= appData.relaxationTracks[appData.currentTrack].duration) {
                            nextTrack();
                        }
                    }, 1000);
                }
            }
        }

        function nextTrack() {
            if (appData.currentTrack < appData.relaxationTracks.length - 1) {
                appData.currentTrack++;
                loadTrack(appData.currentTrack);
                if (appData.isPlaying) {
                    // Jika sedang diputar, mulai trek baru
                    clearInterval(appData.timerInterval);
                    appData.timerInterval = setInterval(() => {
                        appData.currentTime++;
                        updateProgressBar();
                        
                        if (appData.currentTime >= appData.relaxationTracks[appData.currentTrack].duration) {
                            nextTrack();
                        }
                    }, 1000);
                }
            } else {
                // Jika ini trek terakhir, berhenti
                appData.isPlaying = false;
                clearInterval(appData.timerInterval);
                document.getElementById('playPause').innerHTML = '<i class="fas fa-play"></i>';
            }
        }

        function updateProgressBar() {
            const track = appData.relaxationTracks[appData.currentTrack];
            const progress = (appData.currentTime / track.duration) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('currentTime').textContent = formatTime(appData.currentTime);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }
    </script>
</body>
</html>
